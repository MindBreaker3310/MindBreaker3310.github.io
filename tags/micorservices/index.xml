<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Micorservices on MindBreaker3310</title>
    <link>https://mindbreaker3310.github.io/tags/micorservices/</link>
    <description>Recent content in Micorservices on MindBreaker3310</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 28 Dec 2021 11:33:55 +0800</lastBuildDate><atom:link href="https://mindbreaker3310.github.io/tags/micorservices/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>RabbitMQç­†è¨˜</title>
      <link>https://mindbreaker3310.github.io/posts/post/20211228_rabbitmq%E7%AD%86%E8%A8%98.md/</link>
      <pubDate>Tue, 28 Dec 2021 11:33:55 +0800</pubDate>
      
      <guid>https://mindbreaker3310.github.io/posts/post/20211228_rabbitmq%E7%AD%86%E8%A8%98.md/</guid>
      <description>å‰ç½®ä½œæ¥­  RabbitMQçš„å…”å…”iconæ€ªå¯æ„›çš„ï¼Œå¯ä»¥æƒ³åƒæˆéƒµå±€ï¼Œå¯ä»¥æ”¶ä¿¡ä¹Ÿå¯ä»¥é€ä¿¡ï¼Œæ˜¯ä¸€å †å…”å…”å¹«ä½ é€ä¿¡~ğŸ°
 å®‰è£Docker é€édocker-composeä¾†è¨­å®šä¸‹è¼‰ï¼Œalpineæ˜¯è¼•é‡åŒ–é«”ç©è¼ƒå°çš„ç‰ˆæœ¬
#docker-compose.ymlabbitmq:image:rabbitmq:3-management-alpine#docker-compose.override.ymlrabbitmq:container_name:rabbitmqrestart:alwaysports:- &amp;#34;5672:5672&amp;#34;- &amp;#34;15672:15672&amp;#34;#DashBoardçš„portdocker upä¸Šå»å¾Œï¼Œæ¸¬è©¦çœ‹çœ‹èƒ½ä¸èƒ½é€£ç·šåˆ°localhost:15672ï¼Œå¯ä»¥å°±æœƒé€²åˆ°ç™»å…¥ç•«é¢ï¼Œç¬¬ä¸€æ¬¡ç›´æ¥ç™»å…¥å¸³å¯†éƒ½æ˜¯guestã€‚
 MassTransitğŸš é›†é«”æ­è»Šå»RabbitMQçš„æ¦‚å¿µ(?)ï¼Œé€™æ˜¯å°ˆçµ¦.Netç”¨çš„å¥—ä»¶ï¼Œè®“æˆ‘å€‘æ›´ç°¡å–®çš„å»ä½¿ç”¨RabbitMQçš„åŠŸèƒ½
 å»ºç«‹Eventè£½é€ æ©Ÿ  å»ºç«‹EventBus.Messagesé …ç›®å°ˆæ¡ˆ
å®‰è£å¿…è¦å¥—ä»¶
&amp;lt;PackageReference Include=&amp;#34;MassTransit&amp;#34; Version=&amp;#34;7.1.6&amp;#34; /&amp;gt; &amp;lt;PackageReference Include=&amp;#34;MassTransit.AspNetCore&amp;#34; Version=&amp;#34;7.1.6&amp;#34; /&amp;gt; &amp;lt;PackageReference Include=&amp;#34;MassTransit.RabbitMQ&amp;#34; Version=&amp;#34;7.1.6&amp;#34; /&amp;gt; å»ºç«‹Base Eventæœ‰IDèˆ‡å»ºæ§‹æ—¥æœŸï¼Œè®“å…¶ä»–Eventå»ç¹¼æ‰¿å®ƒã€‚
public class IntegrationBaseEvent { public IntegrationBaseEvent() { Id = Guid.NewGuid(); CreationDate = DateTime.UtcNow; } public IntegrationBaseEvent(Guid id, DateTime createDate) { Id = id; CreationDate = createDate; } public Guid Id { get; private set; } public DateTime CreationDate { get; private set; } } å»ºç«‹çµå¸³Event</description>
    </item>
    
    <item>
      <title>Dockerå®¹å™¨åŒ–</title>
      <link>https://mindbreaker3310.github.io/posts/post/20211227_docker%E5%AE%B9%E5%99%A8%E5%8C%96_mssqlserver.md/</link>
      <pubDate>Mon, 27 Dec 2021 10:52:40 +0800</pubDate>
      
      <guid>https://mindbreaker3310.github.io/posts/post/20211227_docker%E5%AE%B9%E5%99%A8%E5%8C%96_mssqlserver.md/</guid>
      <description>å»ºç«‹Dockerfile  å°å°ˆæ¡ˆé …ç›®æŒ‰å³éµ &amp;raquo; Add &amp;raquo; Docker Support &amp;raquo; Linux &amp;raquo; ç¢ºå®š
è©²é …ç›®ä¸‹é¢å°±æœƒæœ‰Dockerfileï¼Œè£¡é¢æ˜¯å»ºç«‹å®¹å™¨çš„æŒ‡ä»¤æ–‡å­—æª”
 å»ºç«‹Docker Compose  å°å°ˆæ¡ˆé …ç›®æŒ‰å³éµ &amp;raquo; Add &amp;raquo; Container Orchestrator Support(å®¹å™¨å”èª¿å™¨æ”¯æ´) &amp;raquo; Docker Compose &amp;raquo; Linux &amp;raquo; ç¢ºå®š
å¯ä»¥å°‡å¤šå€‹containeråˆè€Œç‚ºä¸€ï¼Œä¹Ÿæœƒå¤šä¸€å€‹Docker Compose é …ç›®
#docker-compose.ymlservice:orderdb:#åŠ å…¥çš„serviceimage:mcr.microsoft.com/mssql/server:2019-latest#pullæ˜ åƒæª”çš„ä½ç½®#docker-compose.override.ymlservice:orderdb:container_name:orderdbenvironment:ACCEPT_EULA:&amp;#34;Y&amp;#34;SA_PASSWORD:&amp;#34;Max4129889&amp;#34;#system administratorå¯†ç¢¼restart:alwaysports:- &amp;#34;1433:1433&amp;#34; æ•´åˆã€åŸ·è¡Œæ˜ åƒæª”  åœ¨çµ‚ç«¯æ©ŸåŸ·è¡ŒDocker-compose
docker-compose -f ./docker-compose.yml -f ./docker-compose.override.yml up -d åˆ°é€™é‚ŠåŸºæœ¬ä¸Šå°±æå®šäº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹å®¹å™¨æœ‰æ²’æœ‰å¥½å¥½é‹ä½œ~
å¦‚æœå‡ºç¾ERROR: yaml.parser.ParserError: while parsing a block mappingä¹‹é¡çš„éŒ¯èª¤
å¾ˆæœ‰å¯èƒ½æ˜¯æ’ç‰ˆæœ‰èª¤ï¼Œå¯ä»¥é€éymlæª¢è¦–å™¨ä¾†é€²è¡ŒæŸ¥çœ‹
docker ps  SQL GUI  åœ¨windowsè£¡çš„Visual Studioå¯ä»¥ä½¿ç”¨Server Explorerç›´æ¥é€£ç·šDBé€²è¡ŒæŸ¥çœ‹
åœ¨Macä¸‹çš„Visual Studioè²Œä¼¼æ²’æœ‰é€™å€‹åŠŸèƒ½ï¼Œå¿…é ˆæ”¹ç”¨åˆ¥çš„å·¥å…·ä¾†é€²è¡ŒæŸ¥çœ‹
DBreaver
å…è²»ã€å¥½ç”¨ã€æ”¯æŒå¤šç¨®DBï¼Œæ¨è–¦ä¸€ä¸‹~ğŸ˜„</description>
    </item>
    
    <item>
      <title>ç°¡æ½”æ¶æ§‹ Infrastructure Layer</title>
      <link>https://mindbreaker3310.github.io/posts/post/20211222_%E7%B0%A1%E6%BD%94%E6%9E%B6%E6%A7%8Binfrastructure.md/</link>
      <pubDate>Wed, 22 Dec 2021 13:32:25 +0800</pubDate>
      
      <guid>https://mindbreaker3310.github.io/posts/post/20211222_%E7%B0%A1%E6%BD%94%E6%9E%B6%E6%A7%8Binfrastructure.md/</guid>
      <description>åŸºç¤è¨­æ–½å±¤ï¼Œå°‡æˆ‘å€‘Application Layerèªªçš„é‚£äº›è™•ç†ï¼Œé€£æ¥åˆ°è³‡æ–™åº«ä¸Šã€‚
åœ¨é€™ä¸€å±¤æˆ‘å€‘å°‡ä½¿ç”¨Entity Framework Core AKA EF Coreï¼ŒEFCoreçš„ç›®çš„æ˜¯è®“ç¨‹å¼è¨­è¨ˆå¸«èƒ½å¤ ä»¥ç†Ÿç¿’çš„èªè¨€å»æ“ä½œè³‡æ–™åº«ï¼Œè€Œéä½¿ç”¨sqlèªæ³•ç„¶å¾Œå†è½‰æˆæˆ‘å€‘çš„è³‡æ–™æ¨¡å‹ã€‚
å…ˆå»NuGetè£Microsoft.EntityFrameworkCore.SqlServerï¼Œä½¿ç”¨.Net 5.0çš„è©±ç‰ˆæœ¬åªæ”¯æ´åˆ°5.0.xä»¥ä¸‹ï¼Œ6.0.0ä¸æ”¯æ´ã€‚
 Ordering.API  é€™è·Ÿinfrastructureä¸€æ¨£ï¼Œéƒ½æ˜¯æœ€å¤–é¢ä¸€å±¤ï¼Œå¯«ä¸€èµ·æ¯”è¼ƒå¥½æ•´ç†å§
Controller å¾—åˆ©æ–¼mediatorçš„handlerï¼Œæˆ‘å€‘æ•´å€‹controllerå°±æ˜¯ä¸€å€‹æ¸…çˆ½ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯å»ºç«‹Requestï¼Œä¸Ÿçµ¦Handlerä¾†è™•ç†ï¼Œæœ€å¾ŒæŠŠè³‡æ–™å›å‚³å°±æå®šäº†ã€‚
[ApiController] [Route(&amp;#34;[controller]&amp;#34;)] public class OrderController : ControllerBase { private readonly IMediator _mediator; public OrderController(IMediator mediator) { _mediator = mediator; } [HttpGet(&amp;#34;{userName}&amp;#34;, Name = &amp;#34;GetOrder&amp;#34;)] [ProducesResponseType(typeof(IEnumerable&amp;lt;OrdersVm&amp;gt;), (int)HttpStatusCode.OK)] public async Task&amp;lt;ActionResult&amp;lt;IEnumerable&amp;lt;OrdersVm&amp;gt;&amp;gt;&amp;gt; GetOrdersByUserName(string userName) { //å»ºç«‹Request  var query = new GetOrdersListQuery(userName); //ç™¼é€çµ¦Handlerè™•ç†  List&amp;lt;OrdersVm&amp;gt; orders = await _mediator.Send(query); return Ok(orders); } [HttpPost(Name = &amp;#34;CheckoutOrder&amp;#34;)] [ProducesResponseType(StatusCodes.Status200OK)] public async Task&amp;lt;ActionResult&amp;lt;int&amp;gt;&amp;gt; CheckoutOrder([FromBody] CheckoutOrderCommand command) { var result = await _mediator.</description>
    </item>
    
    <item>
      <title>ç°¡æ½”æ¶æ§‹ Application Layer</title>
      <link>https://mindbreaker3310.github.io/posts/post/20211217_%E7%B0%A1%E6%BD%94%E6%9E%B6%E6%A7%8Bapplication.md/</link>
      <pubDate>Fri, 17 Dec 2021 11:44:52 +0800</pubDate>
      
      <guid>https://mindbreaker3310.github.io/posts/post/20211217_%E7%B0%A1%E6%BD%94%E6%9E%B6%E6%A7%8Bapplication.md/</guid>
      <description>Application Layer  æ³¨é‡æ–¼å•†æ¥­éœ€æ±‚è€Œä¸æ˜¯å¯¦ä½œä¸€äº›å¤–éƒ¨ç³»çµ±çš„æ±è¥¿ï¼ŒDBä¹‹é¡çš„ã€‚
åœ¨é€™ä¸€å±¤è£¡æœ‰ä¸‰å€‹ä¸»è¦çš„è³‡æ–™å¤¾Contractsã€Featuresã€Behaviorsï¼Œåˆ†åˆ¥ç‚ºå­˜æ”¾æœå‹™ä»‹é¢ã€Use caseã€é©—è­‰ç”¨æˆ¶è¡Œç‚ºã€‚
ä¸»è¦åœ¨æ–¼Feturesï¼Œæ ¹æ“šDDDä¸¦ä½¿ç”¨MediatRç‚ºæ¯ä¸€å€‹éœ€æ±‚åšç¨è‡ªçš„CQRSæ“ä½œï¼Œ
 Contracts  å­˜æ”¾å„Servicesçš„interfaceçš„åœ°æ–¹
Persistence é€šç”¨çš„éåŒæ­¥Repositoryä»‹é¢(Asynchronous Generic Repository)
è£¡é¢åŒ…å«å¸¸ç”¨çš„åŠŸèƒ½ã€‚
//æ³›å‹Tå¿…éœ€ç¹¼æ‰¿Domina Layerçš„EntityBase(Idã€createdByã€createDateã€LastModifiedDateç­‰ç­‰çš„æ±è¥¿) public interface IAsyncRepository&amp;lt;T&amp;gt; where T : EntityBase { Task&amp;lt;IReadOnlyList&amp;lt;T&amp;gt;&amp;gt; GetAllAsync(); Task&amp;lt;IReadOnlyList&amp;lt;T&amp;gt;&amp;gt; GetAsync(Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; predicate); Task&amp;lt;IReadOnlyList&amp;lt;T&amp;gt;&amp;gt; GetAsync(Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; predicate = null, Func&amp;lt;IQueryable&amp;lt;T&amp;gt;, IOrderedQueryable&amp;lt;T&amp;gt;&amp;gt; orderBy = null, string includeString = null, bool disableTracking = true); Task&amp;lt;IReadOnlyList&amp;lt;T&amp;gt;&amp;gt; GetAsync(Expression&amp;lt;Func&amp;lt;T, bool&amp;gt;&amp;gt; predicate = null, Func&amp;lt;IQueryable&amp;lt;T&amp;gt;, IOrderedQueryable&amp;lt;T&amp;gt;&amp;gt; orderBy = null, List&amp;lt;Expression&amp;lt;Func&amp;lt;T, object&amp;gt;&amp;gt;&amp;gt; includes = null, bool disableTracking = true); Task&amp;lt;T&amp;gt; GetByIdAsync(int id); Task&amp;lt;T&amp;gt; AddAsync(T entity); Task UpdateAsync(T entity); Task DeleteAsync(T entity); } ä¸‹è¨‚å–®Repositoryä»‹é¢ï¼Œåœ¨é€™é‚Šæˆ‘å€‘å¯ä»¥å»ºç«‹è‡ªå·±çš„æ–¹æ³•ã€åŠŸèƒ½ï¼Œå¾Œé¢è™•ç†Requestæ™‚æœƒç”¨åˆ°ã€‚</description>
    </item>
    
    <item>
      <title>ç°¡æ½”æ¶æ§‹ Domain Layer</title>
      <link>https://mindbreaker3310.github.io/posts/post/2021202_%E7%B0%A1%E6%BD%94%E6%9E%B6%E6%A7%8Bdomain.md/</link>
      <pubDate>Thu, 02 Dec 2021 15:52:49 +0800</pubDate>
      
      <guid>https://mindbreaker3310.github.io/posts/post/2021202_%E7%B0%A1%E6%BD%94%E6%9E%B6%E6%A7%8Bdomain.md/</guid>
      <description>ä»‹ç´¹  æ¥ä¸‹ä¾†çš„ç­†è¨˜æ˜¯æ ¹æ“šç·šä¸Šèª²ç¨‹Microservices Architecture and Implementation on .NET 5æ‰€è¨˜éŒ„ä¸‹ä¾†çš„ï¼Œè¬›è€…çš„å£éŸ³æœ‰é»é‡ï¼Œè½å¾—æœ‰é»åƒåŠ›ï¼Œä»–é€™å€‹å°ˆæ¡ˆåŸºæœ¬ä¸Šé‡åšå¾®è»Ÿæä¾›çš„ç¯„ä¾‹å°ˆæ¡ˆï¼Œé›»å•†ç³»çµ±ï¼Œå®Œç¾å‘ˆç¾å¾®æœå‹™çš„ä½¿ç”¨èˆ‡ä»–çš„å„ªé»ï¼Œä¸€å…±æŠŠæœå‹™åˆ‡æˆå››å€‹ä¸»è¦çš„æœå‹™ï¼ŒCatalog(å•†å“ç›®éŒ„ç³»çµ±)ã€Basket(è³¼ç‰©è»Šç³»çµ±)ã€Discount(æŠ˜æ‰£ç³»çµ±)ã€Ordering(è¨‚å–®ç³»çµ±)ï¼Œä¸¦åˆ†åˆ¥ä½¿ç”¨ä¸åŒçš„è³‡æ–™åº«(mongodbã€redisã€PostgreSQLã€MSSQL)ã€ä¸åŒçš„å‚³è¼¸å”å®š(Rest APIã€Grpc)ã€ä¸åŒçš„æ¶æ§‹(å¤šå±¤å¼æ¶æ§‹ã€ç°¡æ½”æ¶æ§‹)ï¼Œæœ€å¾Œä½¿ç”¨Dockerå®¹å™¨åŒ–ï¼ŒæŠŠä»–å€‘éƒ½æ•´åˆåœ¨ä¸€èµ·é‹ä½œã€‚
æ•´å€‹ç³»çµ±çš„æ¶æ§‹åœ–
å·¥ä½œä¸€é™£å­äº†ï¼Œç¶­è­·çš„ç³»çµ±åŸºæœ¬ä¹Ÿéƒ½ä¸Šæ‰‹äº†(é¾å¤§çš„Web Serviceæ¶æ§‹)ï¼Œä½†é‚„æœ‰è¨±å¤šå‰äººçš„æ™ºæ…§ï¼Œä¸€æ™‚ä¹‹é–“æ˜¯å¾ˆé›£ç†è§£çš„XDï¼Œé€™æ™‚æœ‰ä¸€å€‹ä¹¾æ·¨çš„æ¶æ§‹ï¼Œæˆ–è¨±ä¸Šæ‰‹çš„æ™‚é–“å°±å¯ä»¥æ›´çŸ­äº†ã€‚
 Domain Layer  å»ºç«‹ä¸€å€‹è¨‚å–®ç³»çµ±ä½¿ç”¨Clean Architecture
ä¾ç…§åˆ†å±¤å‰µå»ºå„å€‹ä¸åŒçš„Projectï¼Œ Ordering.API Ordering.Domain Ordering.Application Ordering.infrastructure æ•´å€‹ç³»çµ±çš„æ¶æ§‹åœ–
å»ºç«‹ç›¸ä¾é—œä¿‚Projectå³éµ &amp;gt;&amp;gt; Add &amp;gt;&amp;gt; Reference ç›¸ä¾é—œä¿‚
è©³ç´°å®šç¾©èˆ‡è¨­è¨ˆå¯ä»¥åƒè€ƒ
https://ithelp.ithome.com.tw/articles/10223150 https://ithelp.ithome.com.tw/articles/10223595
 é–‹ç™¼Ordering.Domain Layer  æˆ‘å€‘è¦å…ˆå»ºç«‹å…©å€‹è³‡æ–™å¤¾Commonã€Entities
Common å…¶ä¸­Commonæ”¾çš„æ˜¯æˆ‘å€‘å»ºç«‹Entityçš„åŸºç¤ï¼Œå«æœ‰å…©å€‹abstract classï¼ŒEntityBaseã€ValueObjectï¼Œ
//æˆ‘å€‘æ¯ä¸€å€‹Entityéƒ½è¦çš„å±¬æ€§ public abstract class EntityBase { public int Id { get; protected set; } public string CreatedBy { get; set; } public DateTime CreatedDate { get; set; } public string LastModifiedBy { get; set; } public DateTime?</description>
    </item>
    
    <item>
      <title>Grpc ç­†è¨˜</title>
      <link>https://mindbreaker3310.github.io/posts/post/20211124_grpcmemo.md/</link>
      <pubDate>Wed, 24 Nov 2021 10:12:35 +0800</pubDate>
      
      <guid>https://mindbreaker3310.github.io/posts/post/20211124_grpcmemo.md/</guid>
      <description>ç­†è¨˜  Grpcæ˜¯googleé–‹ç™¼çš„rpc(Remote Procedure Call)æ¡†æ¶ï¼Œç”¨æ–¼é›»è…¦èˆ‡é›»è…¦ä¹‹é–“çš„æºé€šï¼Œå°±åƒé›»è…¦Aå‘¼å«é›»è…¦Båšäº‹æƒ…ï¼Œé›»è…¦Båšå¥½äº‹æƒ…å¾ŒæŠŠçµæœå›å‚³çµ¦é›»è…¦Aï¼Œèˆ‡ä¸€èˆ¬çš„apiä¸åŒçš„åœ°æ–¹åœ¨æ–¼ï¼Œé›»è…¦Aã€Båœ¨é€²è¡ŒGrpcæºé€šå‰ï¼Œéƒ½å¿…é ˆæœ‰protocal buffersæª”æ¡ˆä¾†æŠŠæ ¼å¼èˆ‡æ–¹æ³•å®šç¾©æ¸…æ¥šï¼Œä¸¦ä½¿ç”¨HTTP/2é€²è¡Œå‚³è¼¸ï¼Œå¿«é€Ÿã€ä½å»¶é²ã€æ”¯æŒä¸²æµã€‚
 protocal buffers æª”æ¡ˆ  åœ¨VSè£¡é¢ï¼ŒAdd &amp;raquo; New Project &amp;raquo; é¸gRPC Service &amp;raquo; &amp;hellip;ä¸€äº›åŸºæœ¬è¨­å®š
ç”Ÿæˆæ–°gRPC Serviceå¾Œï¼Œè£¡é¢æœƒæœ‰.protoæª”æ¡ˆ
syntax = &amp;#34;proto3&amp;#34;;//ä½¿ç”¨çš„protocal buffersç‰ˆæœ¬  option csharp_namespace = &amp;#34;MyFirstGrpc.Grpc&amp;#34;;//å‘½åç©ºé–“  package greeter; // å®šç¾©äº¤æ›è³‡æ–™çš„æ ¼å¼ message HelloRequest { string name = 1; } // å®šç¾©äº¤æ›è³‡æ–™çš„æ ¼å¼ message HelloReply { string message = 1; } // å®šç¾©å‘¼å«apiçš„æ–¹æ³• service Greeter { // SayHelloæ–¹æ³•éœ€è¦è¼¸å…¥åƒæ•¸(HelloRequestæ ¼å¼) æœƒå›å‚³(HelloReplyæ ¼å¼)  rpc SayHello (HelloRequest) returns (HelloReply); }  AppSettings ä½¿ç”¨Http2  { &amp;#34;Logging&amp;#34;: { &amp;#34;LogLevel&amp;#34;: { &amp;#34;Default&amp;#34;: &amp;#34;Information&amp;#34;, &amp;#34;Microsoft&amp;#34;: &amp;#34;Warning&amp;#34;, &amp;#34;Microsoft.</description>
    </item>
    
  </channel>
</rss>
